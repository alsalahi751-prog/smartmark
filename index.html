<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>SmartMark - احفظ كل شيء بذكاء</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="احفظ ونظّم كل ما يهمك من الإنترنت: روابط، مقالات، فيديوهات، صور وملفات — في مكان واحد ذكي وآمن.">
  <meta name="theme-color" content="#4CAF50">
  <style>
    :root {
      --primary: #4CAF50;
      --secondary: #2196F3;
      --dark: #212121;
      --light: #f5f5f5;
      --gray: #9E9E9E;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #fafafa;
      color: var(--dark);
    }

    header {
      background: linear-gradient(to right, var(--primary), var(--secondary));
      color: white;
      padding: 20px;
      text-align: center;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    nav {
      background: white;
      padding: 10px;
      display: flex;
      justify-content: space-around;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    nav a {
      text-decoration: none;
      color: var(--dark);
      padding: 10px;
      border-radius: 4px;
    }

    nav a.active {
      background: var(--primary);
      color: white;
    }

    main {
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }

    section {
      display: none;
    }

    section.active {
      display: block;
    }

    .card {
      background: white;
      border-radius: 8px;
      padding: 16px;
      margin: 10px 0;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .form-group {
      margin-bottom: 15px;
    }

    input, textarea, select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 16px;
    }

    button {
      background: var(--primary);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
    }

    button:hover {
      opacity: 0.9;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 15px;
    }

    .folder-card {
      background: #e8f5e9;
      border-left: 4px solid var(--primary);
    }

    .content-card {
      background: #e3f2fd;
      border-left: 4px solid var(--secondary);
    }

    footer {
      text-align: center;
      padding: 20px;
      background: var(--dark);
      color: white;
      margin-top: 40px;
    }

    .hidden {
      display: none;
    }

    .search-bar {
      margin-bottom: 20px;
    }

    .app-logo {
      height: 60px;
      margin: 0 auto;
      display: block;
    }
  </style>
</head>
<body>
  <header>
    <img src="https://i.imgur.com/4Y6jLQg.png" alt="SmartMark Logo" class="app-logo">
    <p>احفظ كل شيء بذكاء</p>
  </header>

  <nav>
    <a href="#" data-tab="home" class="active">الرئيسية</a>
    <a href="#" data-tab="add">إضافة محتوى</a>
    <a href="#" data-tab="folders">المجلدات</a>
    <a href="#" data-tab="search">بحث</a>
    <a href="#" data-tab="settings">الإعدادات</a>
  </nav>

  <main>
    <!-- شاشة الرئيسية -->
    <section id="home" class="active">
      <h2>مرحبًا بك في SmartMark</h2>
      <p>احفظ ونظّم كل ما يهمك من الإنترنت في مكان واحد ذكي وآمن.</p>

      <div class="grid">
        <div class="card folder-card">
          <h3>المجلدات</h3>
          <p>احفظ المحتوى في مجلدات ذكية</p>
          <button onclick="switchTab('folders')">عرض المجلدات</button>
        </div>
        <div class="card content-card">
          <h3>المحفوظات</h3>
          <p>جميع المحتوى المحفوظ في مكان واحد</p>
          <button onclick="switchTab('search')">عرض الكل</button>
        </div>
      </div>
    </section>

    <!-- شاشة إضافة محتوى -->
    <section id="add">
      <h2>إضافة محتوى جديد</h2>
      <form id="add-form">
        <div class="form-group">
          <label>النوع</label>
          <select id="content-type" required>
            <option value="link">رابط</option>
            <option value="article">مقال</option>
            <option value="video">فيديو</option>
            <option value="image">صورة</option>
            <option value="pdf">PDF</option>
            <option value="file">ملف آخر</option>
          </select>
        </div>
        <div class="form-group">
          <label>العنوان</label>
          <input type="text" id="content-title" placeholder="أدخل عنوان المحتوى" required>
        </div>
        <div class="form-group">
          <label>الرابط أو المحتوى</label>
          <textarea id="content-url" placeholder="أدخل الرابط أو النص هنا..." rows="3" required></textarea>
        </div>
        <div class="form-group">
          <label>العلامات (مفصولة بفواصل)</label>
          <input type="text" id="content-tags" placeholder="مثلاً: تعليم، تكنولوجيا، فيديو">
        </div>
        <div class="form-group">
          <label>المجلد</label>
          <select id="content-folder" required>
            <option value="default">المجلد العام</option>
          </select>
        </div>
        <button type="submit">حفظ المحتوى</button>
      </form>
    </section>

    <!-- شاشة المجلدات -->
    <section id="folders">
      <h2>المجلدات</h2>
      <button onclick="showFolderModal()">إضافة مجلد جديد</button>

      <div id="folders-list" class="grid">
        <!-- مجلدات تُعرض هنا -->
      </div>

      <div id="folder-modal" class="hidden">
        <div class="card">
          <h3>إضافة مجلد جديد</h3>
          <input type="text" id="new-folder-name" placeholder="اسم المجلد">
          <button onclick="createFolder()">إنشاء</button>
          <button onclick="hideFolderModal()">إلغاء</button>
        </div>
      </div>
    </section>

    <!-- شاشة البحث -->
    <section id="search">
      <h2>البحث في المحفوظات</h2>
      <input type="text" class="search-bar" id="search-input" placeholder="ابحث في العناوين أو العلامات...">
      
      <div id="search-results" class="grid">
        <!-- نتائج البحث تُعرض هنا -->
      </div>
    </section>

    <!-- شاشة الإعدادات -->
    <section id="settings">
      <h2>الإعدادات</h2>
      <div class="card">
        <h3>الحساب</h3>
        <p>تسجيل الدخول للمزامنة السحابية</p>
        <button onclick="login()">تسجيل الدخول</button>
      </div>
      <div class="card">
        <h3>النسخ الاحتياطي</h3>
        <p>تصدير المحفوظات إلى ملف JSON</p>
        <button onclick="exportData()">تصدير البيانات</button>
      </div>
      <div class="card">
        <h3>سياسة الخصوصية</h3>
        <button onclick="showPrivacyPolicy()">عرض سياسة الخصوصية</button>
      </div>
    </section>
  </main>

  <footer>
    <p>SmartMark &copy; 2025 | احفظ كل شيء بذكاء</p>
  </footer>

  <script>
    // --- بيانات التطبيق ---
    let folders = JSON.parse(localStorage.getItem('smartmark-folders')) || [{ id: 'default', name: 'المجلد العام', createdAt: new Date().toISOString() }];
    let contents = JSON.parse(localStorage.getItem('smartmark-contents')) || [];

    // --- تهيئة التطبيق ---
    document.addEventListener('DOMContentLoaded', () => {
      renderFolders();
      setupEventListeners();
    });

    // --- التبديل بين الشاشات ---
    function switchTab(tabName) {
      document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
      document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));

      document.getElementById(tabName).classList.add('active');
      document.querySelector(`nav a[data-tab="${tabName}"]`).classList.add('active');
    }

    // --- إعداد الأحداث ---
    function setupEventListeners() {
      document.querySelectorAll('nav a').forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          switchTab(e.target.getAttribute('data-tab'));
        });
      });

      document.getElementById('add-form').addEventListener('submit', (e) => {
        e.preventDefault();
        addContent();
      });

      document.getElementById('search-input').addEventListener('input', searchContents);

      // إضافة المجلدات إلى القائمة المنسدلة
      const folderSelect = document.getElementById('content-folder');
      folders.forEach(folder => {
        const option = document.createElement('option');
        option.value = folder.id;
        option.textContent = folder.name;
        folderSelect.appendChild(option);
      });
    }

    // --- وظائف المجلدات ---
    function renderFolders() {
      const container = document.getElementById('folders-list');
      container.innerHTML = '';
      folders.forEach(folder => {
        const card = document.createElement('div');
        card.className = 'card folder-card';
        card.innerHTML = `
          <h3>${folder.name}</h3>
          <p>تم الإنشاء: ${new Date(folder.createdAt).toLocaleDateString()}</p>
          <p>${contents.filter(c => c.folderId === folder.id).length} عناصر</p>
          <button onclick="viewFolder('${folder.id}')">عرض المحتوى</button>
        `;
        container.appendChild(card);
      });
    }

    function showFolderModal() {
      document.getElementById('folder-modal').classList.remove('hidden');
    }

    function hideFolderModal() {
      document.getElementById('folder-modal').classList.add('hidden');
    }

    function createFolder() {
      const name = document.getElementById('new-folder-name').value.trim();
      if (name) {
        const newFolder = { id: Date.now().toString(), name, createdAt: new Date().toISOString() };
        folders.push(newFolder);
        localStorage.setItem('smartmark-folders', JSON.stringify(folders));

        // تحديث القائمة المنسدلة
        const folderSelect = document.getElementById('content-folder');
        const option = document.createElement('option');
        option.value = newFolder.id;
        option.textContent = newFolder.name;
        folderSelect.appendChild(option);

        renderFolders();
        document.getElementById('new-folder-name').value = '';
        hideFolderModal();
      }
    }

    // --- وظائف المحتوى ---
    function addContent() {
      const type = document.getElementById('content-type').value;
      const title = document.getElementById('content-title').value;
      const url = document.getElementById('content-url').value;
      const tags = document.getElementById('content-tags').value.split(',').map(t => t.trim()).filter(t => t);
      const folderId = document.getElementById('content-folder').value;

      const newContent = {
        id: Date.now(),
        type,
        title,
        url,
        tags,
        folderId,
        createdAt: new Date().toISOString()
      };

      contents.push(newContent);
      localStorage.setItem('smartmark-contents', JSON.stringify(contents));

      alert('تم حفظ المحتوى بنجاح!');
      document.getElementById('add-form').reset();
    }

    function viewFolder(folderId) {
      const folder = folders.find(f => f.id === folderId);
      if (folder) {
        alert(`عرض المحتوى في المجلد: ${folder.name}`);
        // يمكنك هنا توجيه المستخدم لشاشة عرض المحتوى حسب المجلد
      }
    }

    function searchContents() {
      const query = document.getElementById('search-input').value.toLowerCase();
      const resultsContainer = document.getElementById('search-results');
      resultsContainer.innerHTML = '';

      const filtered = contents.filter(item =>
        item.title.toLowerCase().includes(query) ||
        item.tags.some(tag => tag.toLowerCase().includes(query))
      );

      filtered.forEach(item => {
        const card = document.createElement('div');
        card.className = 'card content-card';
        card.innerHTML = `
          <h3>${item.title}</h3>
          <p><strong>النوع:</strong> ${item.type}</p>
          <p><strong>العلامات:</strong> ${item.tags.join(', ')}</p>
          <p><strong>المجلد:</strong> ${folders.find(f => f.id === item.folderId)?.name || 'غير محدد'}</p>
          <a href="${item.url}" target="_blank">عرض المحتوى</a>
        `;
        resultsContainer.appendChild(card);
      });
    }

    // --- وظائف الإعدادات ---
    function login() {
      alert('نظام تسجيل الدخول قيد التطوير');
    }

    function exportData() {
      const dataStr = "text/json;charset=utf-8," + encodeURIComponent(JSON.stringify({ folders, contents }));
      const downloadAnchorNode = document.createElement('a');
      downloadAnchorNode.setAttribute("href", dataStr);
      downloadAnchorNode.setAttribute("download", "smartmark-backup.json");
      document.body.appendChild(downloadAnchorNode);
      downloadAnchorNode.click();
      downloadAnchorNode.remove();
    }

    function showPrivacyPolicy() {
      const policyWindow = window.open('', '_blank');
      policyWindow.document.write(`
        <!DOCTYPE html>
        <html lang="ar">
        <head>
          <meta charset="UTF-8">
          <title>سياسة الخصوصية - SmartMark</title>
        </head>
        <body>
          <h1>سياسة الخصوصية</h1>
          <p>نحن في تطبيق <strong>SmartMark</strong> نحترم خصوصية المستخدمين ونلتزم بحماية بياناتهم وفقًا لأفضل الممارسات.</p>
          <h2>المعلومات التي نقوم بجمعها</h2>
          <ul>
            <li>المحتوى الذي يقوم المستخدم بحفظه داخل التطبيق (روابط، ملفات، وسائط).</li>
            <li>بيانات تقنية غير شخصية مثل نوع الجهاز ونظام التشغيل لأغراض تحسين الأداء.</li>
          </ul>
          <h2>كيفية استخدام المعلومات</h2>
          <ul>
            <li>تشغيل التطبيق وتقديم وظائفه الأساسية.</li>
            <li>تحسين تجربة المستخدم وتطوير الميزات.</li>
            <li>ضمان أمان واستقرار الخدمة.</li>
          </ul>
          <h2>حماية البيانات</h2>
          <p>نطبّق إجراءات تقنية وتنظيمية مناسبة لحماية بيانات المستخدم من الوصول غير المصرح به أو الفقدان.</p>
          <h2>مشاركة البيانات</h2>
          <p>لا نقوم ببيع أو تأجير أو مشاركة بيانات المستخدم مع أي طرف ثالث.</p>
          <h2>التغييرات على سياسة الخصوصية</h2>
          <p>قد يتم تحديث هذه السياسة من وقت لآخر وسيتم نشر أي تعديل على هذه الصفحة.</p>
          <h2>التواصل معنا</h2>
          <p>يمكن التواصل معنا من داخل التطبيق في حال وجود أي استفسار.</p>
        </body>
        </html>
      `);
    }

    // --- دعم PWA ---
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js').then(() => {
          console.log('SW registered.');
        }).catch(err => console.error('SW failed:', err));
      });
    }
  </script>

  <!-- Service Worker Code -->
  <script>
    const swCode = `
      const CACHE_NAME = 'smartmark-v1';
      const urlsToCache = ['/', '/index.html'];

      self.addEventListener('install', (event) => {
        event.waitUntil(
          caches.open(CACHE_NAME).then((cache) => cache.addAll(urlsToCache))
        );
      });

      self.addEventListener('fetch', (event) => {
        event.respondWith(
          caches.match(event.request).then((response) => response || fetch(event.request))
        );
      });
    `;

    const blob = new Blob([swCode], { type: 'application/javascript' });
    navigator.serviceWorker && navigator.serviceWorker.register(URL.createObjectURL(blob), { scope: './' });
  </script>

  <!-- Manifest Code -->
  <script>
    const manifest = {
      name: "SmartMark - احفظ كل شيء بذكاء",
      short_name: "SmartMark",
      start_url: "/",
      display: "standalone",
      background_color: "#ffffff",
      theme_color: "#4CAF50",
      icons: [
        {
          src: "https://i.imgur.com/0sXZk7P.png", // أيقونة 192x192
          sizes: "192x192",
          type: "image/png"
        },
        {
          src: "https://i.imgur.com/0sXZk7P.png", // أيقونة 512x512
          sizes: "512x512",
          type: "image/png"
        }
      ]
    };

    const manifestBlob = new Blob([JSON.stringify(manifest)], { type: 'application/json' });
    const manifestUrl = URL.createObjectURL(manifestBlob);
    document.querySelector('link[rel="manifest"]').href = manifestUrl;
  </script>
</body>
</html>
